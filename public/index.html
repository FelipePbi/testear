<!DOCTYPE html>
<html>
  <head>
    <title>iFood - Teste AR</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="styles.css" />

    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="gesture-detector.js"></script>
    <script src="gesture-handler.js"></script>

    <style type="text/css">
      .a-canvas {
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
      }
      .a-canvas.a-grab-cursor:hover {
        cursor: grab;
        cursor: -moz-grab;
        cursor: -webkit-grab;
      }
      canvas.a-canvas.a-mouse-cursor-hover:hover {
        cursor: pointer;
      }
    </style>

    <script type="text/javascript">
      // AFRAME.registerComponent("physics-image-target", {
      //   schema: {
      //     name: { type: "string" },
      //   },
      //   init: function () {
      //     console.log("CARREGOU 1");
      //     const object3D = this.el.object3D;
      //     const name = this.data.name;
      //     const scene = this.el.sceneEl;
      //     const portalPos = this.el;
      //     var treeShook = false;
      //     object3D.visible = false;

      //     let attachment = scene.querySelector("#attachment");
      //     let text = document.querySelector("#shake-tree");
      //     let videotop = scene.querySelector("#palm");
      //     // hideImage handles hiding the virtual object when the image target is lost
      //     const imageFound = (e) => {
      //       showImage(e);
      //       console.log("ifoood");
      //     };

      //     const showImage = ({ detail }) => {
      //       if (name != detail.name) {
      //         return;
      //       }
      //       object3D.position.copy(detail.position);
      //       object3D.quaternion.copy(detail.rotation);
      //       object3D.scale.set(detail.scale, detail.scale, detail.scale);
      //       object3D.visible = true;
      //     };

      //     const imageLost = (e) => {
      //       // object3D.visible = false
      //     };

      //     scene.addEventListener("xrimagefound", imageFound);
      //     scene.addEventListener("xrimageupdated", showImage);
      //     scene.addEventListener("xrimagelost", imageLost);
      //   },
      // });

      AFRAME.registerComponent("gallery", {
        schema: {},
        init: function () {
          var image1 = document.querySelector("#index1");
          image1.addEventListener("click", function (e) {
            alert("CLICKOU");
            window.open("https://www.google.com.br");
          });
          var image2 = document.querySelector("#index2");
          image2.addEventListener("click", function (e) {
            alert("CLICKOU");
            window.open("https://www.google.com.br");
          });
          var image3 = document.querySelector("#index3");
          image3.addEventListener("click", function (e) {
            alert("CLICKOU");
            window.open("https://www.google.com.br");
          });
          var image4 = document.querySelector("#index4");
          image4.addEventListener("click", function (e) {
            alert("CLICKOU");
            window.open("https://www.google.com.br");
          });
          var image5 = document.querySelector("#index5");
          image5.addEventListener("click", function (e) {
            alert("CLICKOU");
            window.open("https://www.google.com.br");
          });
        },
      });
    </script>
  </head>

  <body>
    <a-scene
      gallery
      vr-mode-ui="enabled: false;"
      embedded
      arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
      renderer="antialias: true;
      logarithmicDepthBuffer: auto;
      colorManagement: true;
      sortObjects: false;
      physicallyCorrectLights: true;
      precision: low;
      maxCanvasWidth: 1024;
      maxCanvasHeight: 1024;"
    >
      <a-assets>
        <img id="iFood1" src="assets/logo-ifood1.png" />
        <img id="iFood2" src="assets/logo-ifood2.png" />
        <img id="iFood3" src="assets/logo-ifood3.png" />
        <img id="iFood4" src="assets/logo-ifood4.png" />
        <img id="iFood5" src="assets/logo-ifood5.png" />
        <img id="myCustomImage" src="preload.png" />
      </a-assets>

      <a-marker preset="hiro" emitevents="true">
        <a-entity physics-image-target="name: 03" id="palm" rotation="-90 360 0">
          <a-image
            id="index1"
            class="cantap"
            position="0.8 1.8 0"
            rotation="0 0 0"
            scale="1 1 1"
            width="1.7"
            height="0.862"
            opacity="1"
            src="#iFood1"
            roughness="1"
            visible="true"
            material=""
            geometry=""
          >
          </a-image>
          <a-image
            id="index2"
            class="cantap"
            position="1.3 -0.6 0"
            rotation="0 0 0"
            scale="1 1 1"
            width="1.7"
            height="0.862"
            opacity="1"
            src="#iFood2"
            roughness="1"
            visible="true"
          >
          </a-image>
          <a-image
            id="index3"
            class="cantap"
            position="1.3 1 0"
            rotation="0 0 0"
            scale="1 1 1"
            width="1.7"
            height="0.862"
            opacity="1"
            src="#iFood3"
            roughness="1"
            visible="true"
          >
          </a-image>
          <a-image
            id="index4"
            class="cantap"
            position="0.8 -1.4 0"
            rotation="0 0 0"
            scale="1 1 1"
            width="1.7"
            height="0.862"
            opacity="1"
            src="#iFood4"
            roughness="1"
            visible="true"
          >
          </a-image>
          <a-image
            id="index5"
            class="cantap"
            position="1.3 0.2 0"
            rotation="0 0 0"
            scale="1 1 1"
            width="1.7"
            height="0.862"
            opacity="1"
            src="#iFood5"
            roughness="1"
            visible="true"
          >
          </a-image>
        </a-entity>
      </a-marker>
      <canvas class="a-canvas a-grab-cursor" data-aframe-canvas="true" width="1920" height="969"></canvas>
      <a-entity
        camera
        raycaster="objects: .cantap"
        cursor="fuse: false; rayOrigin: mouse;"
        wasd-controls-enabled="true"
      ></a-entity>
    </a-scene>
  </body>
</html>
